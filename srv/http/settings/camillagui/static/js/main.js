(this.webpackJsonpcamillagui=this.webpackJsonpcamillagui||[]).push([[0],{122:function(e,t,n){e.exports=n.p+"static/media/camilladsp.95719842.svg"},18:function(e,t,n){},189:function(e,t,n){e.exports=n(303)},303:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n(7),i=n(1),l=n(8),o=n(9),s=(n(190),n(18),n(0)),c=n.n(s),u=n(53),p=n(11),f=n(20),d=n(24),m=n.n(d),h=n(4),g=n(12),v=n(5),y=n.n(v),b=n(10),C=n(36),E=n.n(C),k=n(37),x=n(119);n(116);function S(e,t){var n=m()(e);return t(n),n}function w(e){return e.sort((function(e,t){return e.localeCompare(t)})),e}function F(e,t){O(e,t,t-1)}function _(e,t){O(e,t,t+1)}function O(e,t,n){var a=e.splice(t,1);e.splice.apply(e,[n,0].concat(Object(f.a)(a)))}function j(){return getComputedStyle(document.body)}function N(e,t){var n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e,n.hidden=!0,document.body.appendChild(n),n.innerHTML="abcdefg",n.click()}function D(e,t,n,a){return A.apply(this,arguments)}function A(){return(A=Object(b.a)(y.a.mark((function e(t,n,a,r){var i,l,o,s,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=new FormData,l=n.target.files,o=[],s=0;s<l.length;s++)c=l[s],o.push(c.name),i.append("file"+s,c,c.name);return n.target.value="",e.prev=5,e.next=8,fetch("/api/upload".concat(t,"s"),{method:"POST",body:i});case 8:a(o),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),r(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}function P(e){return c.a.createElement("fieldset",{className:"box",style:e.style},c.a.createElement("legend",null,c.a.createElement("div",{className:"horizontally-spaced-content",style:{display:"flex",flexDirection:"row",alignItems:"center"}},e.title)),e.children)}function L(e){var t=e.tooltip,n=e.checked,a=e.onChange,r=e.style;return c.a.createElement("label",{"data-tip":t,className:"checkbox-area",style:r},c.a.createElement("input",{type:"checkbox","data-tip":t,checked:n,onChange:function(e){return a(e.target.checked)}}))}function q(e){return c.a.createElement("div",{"data-tip":e["data-tip"],className:"button button-with-text",style:e.style,onClick:e.onClick},e.text)}function T(e){var t=Object.assign({color:"var(--button-add-icon-color)"},e.style);return c.a.createElement(I,{icon:h.n,style:t,tooltip:e.tooltip,onClick:e.onClick})}function B(e){return c.a.createElement(I,{style:{color:"var(--button-remove-icon-color)"},smallButton:e.smallButton,icon:h.i,tooltip:e.tooltip,onClick:e.onClick})}function M(e){return c.a.createElement(I,{icon:h.f,tooltip:e.tooltip,onClick:e.onClick})}function V(e){var t=Object.assign({verticalAlign:"bottom"},e.style);return c.a.createElement("label",{"data-tip":e.tooltip},c.a.createElement("input",{style:{display:"none"},type:"file",onChange:e.onChange,multiple:e.multiple}),c.a.createElement(I,{smallButton:e.smallButton,icon:e.icon,tooltip:e.tooltip,className:e.className,style:t}))}function I(e){var t=e.icon,n=e.tooltip,a=e.className,r=e.enabled,i=e.onClick,l=void 0===i||!1===r?function(){}:i,o="button button-with-icon";return!1===r&&(o+=" disabled-button"),!0===e.smallButton&&(o+=" smallbutton"),void 0!==a&&(o+=" "+a),c.a.createElement("div",{onClick:l,"data-tip":n,className:o,style:e.style},c.a.createElement(E.a,{path:t,size:"24px"}))}function z(e){return c.a.createElement("span",{"data-tip":e.tooltip,style:e.style},c.a.createElement(E.a,{path:e.icon,size:"15px"}))}function R(e){return c.a.createElement("div",{style:{textAlign:"right",cursor:"pointer"},onClick:e.onClick},"\u2716")}function U(e){var t=e.small?{width:"min-content"}:{};return c.a.createElement("label",{className:"setting","data-tip":e["data-tip"],style:t},c.a.createElement("span",{className:"setting-label"},e.desc),e.children)}function H(e){var t=e.small;return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{desc:e.desc,"data-tip":e["data-tip"],small:t},c.a.createElement(K,Object.assign({},e,{className:"setting-input"+(t?" small-setting-input":""),style:e.error?Z:void 0}))),c.a.createElement($,{message:e.error}))}function K(e){var t=e.min,n=e.max;return c.a.createElement(G,Object.assign({},e,{asString:function(e){return e.toString()},parseValue:function(e){var a=parseInt(e);return isNaN(a)||void 0!==t&&a<t||void 0!==n&&a>n?void 0:a}}))}function W(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{desc:e.desc,"data-tip":e["data-tip"]},c.a.createElement(J,{value:e.value,"data-tip":e["data-tip"],onChange:e.onChange,className:"setting-input"})),c.a.createElement($,{message:e.error}))}function J(e){return c.a.createElement(G,{value:e.value,"data-tip":e["data-tip"],onChange:e.onChange,asString:function(e){return e.toString()},parseValue:function(e){var t=parseFloat(e);return isNaN(t)?void 0:t},className:e.className,style:Object(p.a)(Object(p.a)({},e.style),e.error?Z:void 0)})}function Q(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{desc:e.desc,"data-tip":e["data-tip"]},c.a.createElement(G,{className:"setting-input",value:e.value,"data-tip":e["data-tip"],asString:function(e){return e.join(", ")},parseValue:function(e){var t,n=[],a=e.split(","),r=Object(g.a)(a);try{for(r.s();!(t=r.n()).done;){var i=t.value,l=parseFloat(i);if(isNaN(l))return;n.push(l)}}catch(o){r.e(o)}finally{r.f()}return n},onChange:e.onChange,style:e.error?Z:void 0})),c.a.createElement($,{message:e.error}))}var G=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).updateValue=r.updateValue.bind(Object(i.a)(r)),r.state={rawValue:e.asString(e.value)},r}return Object(r.a)(n,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({rawValue:this.props.asString(this.props.value)})}},{key:"updateValue",value:function(e){this.setState({rawValue:e});var t=this.props.parseValue(e);void 0!==t&&this.props.onChange(t)}},{key:"render",value:function(){var e=this,t=this.props,n=void 0!==t.parseValue(this.state.rawValue);return c.a.createElement("input",{type:t.withControls?"number":"text",min:t.min,max:t.max,value:this.state.rawValue,"data-tip":t["data-tip"],className:t.className,style:n?t.style:Object(p.a)(Object(p.a)({},t.style),Z),onChange:function(t){return e.updateValue(t.target.value)}})}}]),n}(c.a.Component),Z=Object.freeze({backgroundColor:"var(--error-field-background-color)"});function $(e){return e.message?c.a.createElement("div",{style:{color:"var(--error-text-color)",whiteSpace:"pre-wrap"}},e.message):null}function X(e){var t=e.small;return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{desc:e.desc,"data-tip":e["data-tip"],small:t},c.a.createElement("div",{className:"setting-input"+(t?" small-setting-input":""),"data-tip":e["data-tip"],style:{cursor:"pointer"}},c.a.createElement("input",{style:{marginLeft:0,marginTop:"8px",marginBottom:"8px"},type:"checkbox",checked:e.value,"data-tip":e["data-tip"],onChange:function(t){return e.onChange(t.target.checked)}}))),c.a.createElement($,{message:e.error}))}function Y(e){var t="setting-input"+(e.className?" "+e.className:"");return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{desc:e.desc,"data-tip":e["data-tip"]},c.a.createElement(ee,Object.assign({},e,{className:t,style:e.error?Z:void 0}))),c.a.createElement($,{message:e.error}))}function ee(e){var t=e.options,n=e.value,a=Array.isArray(t)?function(e){var t={};return e.forEach((function(e){return t[e]=e})),t}(t):t;return Object.keys(a).includes(n)||(a[n]=n),c.a.createElement("select",{id:e.desc,name:e.desc,value:n,"data-tip":e["data-tip"],onChange:function(t){return e.onChange(t.target.value)},style:e.style,className:e.className},Object.keys(a).map((function(e){return c.a.createElement("option",{key:e,value:e},a[e])})))}function te(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{desc:e.desc,"data-tip":e["data-tip"]},c.a.createElement(ne,{className:"setting-input",value:e.value,"data-tip":e["data-tip"],style:e.error?Z:void 0,onChange:e.onChange})),c.a.createElement($,{message:e.error}))}function ne(e){return c.a.createElement("input",{type:"text",value:e.value,"data-tip":e["data-tip"],className:e.className,style:e.style,onChange:function(t){return e.onChange(t.target.value)}})}function ae(e){function t(e,t,n,a){return e.map((function(e,r){return{x:n*e,y:a*t[r]}}))}var n=e.data,a={labels:[n.hasOwnProperty("name")?n.name:""],datasets:[]},r=!1,i=!1,l=!1,o=!1,s=!1,u=j(),p=u.getPropertyValue("--axes-color"),f=u.getPropertyValue("--text-color"),d=u.getPropertyValue("--gain-color"),m=u.getPropertyValue("--phase-color"),h=u.getPropertyValue("--impulse-color");if(n.hasOwnProperty("magnitude")){var g=t(n.f,n.magnitude,1,1);i=!0,o=!0,a.datasets.push({label:"Gain",fill:!1,borderColor:d,pointRadius:0,showLine:!0,data:g,yAxisID:"gain",xAxisID:"freq"})}if(n.hasOwnProperty("phase")){var v=t(n.f,n.phase,1,1);i=!0,l=!0,a.datasets.push({label:"Phase",fill:!1,borderColor:m,pointRadius:0,showLine:!0,data:v,yAxisID:"phase",xAxisID:"freq"})}if(n.hasOwnProperty("impulse")){var y=t(n.time,n.impulse,1e3,1);r=!0,s=!0,a.datasets.push({label:"Impulse",fill:!1,borderColor:h,pointRadius:0,showLine:!0,data:y,yAxisID:"ampl",xAxisID:"time"})}var b={scales:{xAxes:[],yAxes:[]},legend:{labels:{fontColor:f}}};return i&&b.scales.xAxes.push({id:"freq",type:"logarithmic",position:"bottom",scaleLabel:{display:!0,labelString:"Frequency, Hz",fontColor:f},gridLines:{zeroLineColor:p,color:p},ticks:{min:0,max:3e4,maxRotation:0,fontColor:f,callback:function(e,t,n){return 10===e||100===e?e.toString():1e3===e?"1k":1e4===e?"10k":""}},afterBuildTicks:function(e){e.ticks=[10,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4,2e4]}}),r&&b.scales.xAxes.push({id:"time",type:"linear",position:"top",scaleLabel:{display:!0,labelString:"Time, ms",fontColor:f},ticks:{fontColor:f},gridLines:{display:!1}}),o&&b.scales.yAxes.push({id:"gain",type:"linear",position:"left",ticks:{fontColor:d},scaleLabel:{display:!0,labelString:"Gain, dB",fontColor:d},gridLines:{zeroLineColor:p,color:p}}),l&&b.scales.yAxes.push({id:"phase",type:"linear",position:"right",ticks:{fontColor:m,suggestedMin:-180,suggestedMax:180},scaleLabel:{display:!0,labelString:"Phase, deg",fontColor:m},gridLines:{display:!1}}),s&&b.scales.yAxes.push({id:"ampl",type:"linear",position:"right",ticks:{fontColor:h},scaleLabel:{display:!0,labelString:"Amplitude",fontColor:h},gridLines:{display:!1}}),c.a.createElement(k.a,{open:e.open,onClose:e.onClose},c.a.createElement(R,{onClick:e.onClose}),c.a.createElement(x.Scatter,{data:a,options:b}))}function re(e){var t=e.open,n=e.items,a=e.onSelect,r=e.onClose;return c.a.createElement(k.a,{open:t,closeOnDocumentClick:!0,onClose:r,contentStyle:{width:"max-content"}},c.a.createElement(R,{onClick:r}),e.header,c.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.map((function(e){return c.a.createElement(q,{key:e,text:e,style:{justifyContent:"flex-start"},onClick:function(){return function(e){a(e),r()}(e)}})}))))}function ie(e){var t=le(e)?e.filters:e;return w(Object.keys(t))}function le(e){return void 0!==e.devices}function oe(e,t){for(var n,a=1;;a++)if(n=a,!t.includes(e+n.toString()))return e+a.toString()}function se(e){var t=le(e)?e.mixers:e;return w(Object.keys(t))}function ce(e,t){if(t.length>=e)throw new Error("Cannot add more than ".concat(e," (out) mappings"));return{dest:t.length,sources:[ue(0,[])],mute:!1}}function ue(e,t){return{channel:t.length<e?t.length:0,gain:0,inverted:!1,mute:!1}}function pe(e){var t=ie(e);return{type:"Filter",channel:0,names:1===t.length?[t[0]]:[""]}}var fe=["FastAsync","BalancedAsync","AccurateAsync","Synchronous"],de=["S16LE","S24LE","S24LE3","S32LE","FLOAT32LE","FLOAT64LE"],me=function(){};function he(e){return function(t){var n=t.path,a=t.includeChildren?function(e){return function(e,t){if(e.length<t.length)return!1;for(var n=0,a=t.length;n<a;n++)if(e[n]!==t[n])return!1;return!0}(e,n)}:function(e){return function(e,t){if(e.length!==t.length)return!1;for(var n=0,a=t.length;n<a;n++)if(e[n]!==t[n])return!1;return!0}(e,n)},r=e.filter((function(e){return a(e[0])})).map((function(e){return e[1]})).join("\n");return r.length>0?r:void 0}}function ge(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return function(t){return e({path:n.concat(t.path),includeChildren:t.includeChildren})}}var ve=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).filterNames=r.filterNames.bind(Object(i.a)(r)),r.addFilter=r.addFilter.bind(Object(i.a)(r)),r.removeFilter=r.removeFilter.bind(Object(i.a)(r)),r.renameFilter=r.renameFilter.bind(Object(i.a)(r)),r.isFreeFilterName=r.isFreeFilterName.bind(Object(i.a)(r)),r.updateFilter=r.updateFilter.bind(Object(i.a)(r)),r.plotFilter=r.plotFilter.bind(Object(i.a)(r)),r.closePopup=r.closePopup.bind(Object(i.a)(r)),r.updateAvailableCoeffFiles=r.updateAvailableCoeffFiles.bind(Object(i.a)(r)),r.state={popupVisible:!1,data:{name:""},filterKeys:{},availableCoeffFiles:[]},r.filterNames().forEach((function(e,t){return r.state.filterKeys[e]=t})),r.updateAvailableCoeffFiles(),r}return Object(r.a)(n,[{key:"filterNames",value:function(){return ie(this.props.filters)}},{key:"addFilter",value:function(){var e=this;this.props.updateConfig((function(t){var n=oe("New Filter ",ie(t.filters));e.setState((function(e){return S(e,(function(t){return t.filterKeys[n]=1+Math.max.apply(Math,[0].concat(Object(f.a)(Object.values(e.filterKeys))))}))})),t.filters[n]={type:"Biquad",parameters:{type:"Lowpass",q:.5,freq:1e3}}}))}},{key:"removeFilter",value:function(e){var t=this;this.props.updateConfig((function(n){!function(e,t){delete e.filters[t];var n,a=Object(g.a)(e.pipeline);try{for(a.s();!(n=a.n()).done;){var r=n.value;"Filter"===r.type&&(r.names=r.names.filter((function(e){return e!==t})))}}catch(i){a.e(i)}finally{a.f()}}(n,e),t.setState((function(t){return S(t,(function(t){return delete t.filterKeys[e]}))}))}))}},{key:"renameFilter",value:function(e,t){var n=this;this.isFreeFilterName(t)&&this.props.updateConfig((function(a){n.setState((function(n){return S(n,(function(n){n.filterKeys[t]=n.filterKeys[e],delete n.filterKeys[e]}))})),function(e,t,n){if(ie(e).includes(n))throw new Error("Filter '".concat(n,"' already exists"));e.filters[n]=e.filters[t],delete e.filters[t];var a,r=Object(g.a)(e.pipeline);try{for(r.s();!(a=r.n()).done;){var i=a.value;if("Filter"===i.type)for(var l=0;l<i.names.length;l++)i.names[l]===t&&(i.names[l]=n)}}catch(o){r.e(o)}finally{r.f()}}(a,e,t)}))}},{key:"isFreeFilterName",value:function(e){return!this.filterNames().includes(e)}},{key:"updateFilter",value:function(e,t){this.props.updateConfig((function(n){return t(n.filters[e])}))}},{key:"plotFilter",value:function(e){var t=this;fetch("/api/evalfilter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,config:this.props.filters[e],samplerate:this.props.samplerate,channels:this.props.channels})}).then((function(e){return e.json().then((function(e){return t.setState({popupVisible:!0,data:e})}))}),(function(e){return console.log("Failed",e)}))}},{key:"closePopup",value:function(){this.setState({popupVisible:!1})}},{key:"updateAvailableCoeffFiles",value:function(){var e=this;fetch("/api/storedcoeffs").then((function(t){return t.json().then((function(t){return e.setState({availableCoeffFiles:t})}))}),(function(e){return console.log("Could not load stored coeffs",e)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,a=t.errors;return c.a.createElement("div",{className:"tabpanel"},c.a.createElement($,{message:a({path:[]})}),this.filterNames().map((function(t){return c.a.createElement(be,{key:e.state.filterKeys[t],name:t,filter:n[t],errors:ge(a,t),availableCoeffFiles:e.state.availableCoeffFiles,updateFilter:function(n){return e.updateFilter(t,n)},rename:function(n){return e.renameFilter(t,n)},isFreeFilterName:e.isFreeFilterName,remove:function(){return e.removeFilter(t)},plot:function(){return e.plotFilter(t)},updateAvailableCoeffFiles:e.updateAvailableCoeffFiles,coeffDir:e.props.coeffDir})})),c.a.createElement(T,{tooltip:"Add a new filter",onClick:this.addFilter}),c.a.createElement(ae,{key:"plot-filter-popup",open:this.state.popupVisible,data:this.state.data,onClose:this.closePopup}))}}]),n}(c.a.Component);function ye(e){return"Conv"===e.type&&("Raw"===e.parameters.type||"Wav"===e.parameters.type)}var be=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).uploadCoeffs=r.uploadCoeffs.bind(Object(i.a)(r)),r.pickFilterFile=r.pickFilterFile.bind(Object(i.a)(r)),r.updateDefaults=r.updateDefaults.bind(Object(i.a)(r)),r.updateFilterParamsWithDefaults=r.updateFilterParamsWithDefaults.bind(Object(i.a)(r)),r.state={popupOpen:!1,showDefaults:!1,filterDefaults:{}},ye(r.props.filter)&&r.updateDefaults(r.props.filter.parameters.filename),r}return Object(r.a)(n,[{key:"uploadCoeffs",value:function(e){var t=this;D("coeff",e,(function(e){t.setState({uploadState:{success:!0}});var n=t.props.updateAvailableCoeffFiles;t.pickFilterFile(e[0]),n()}),(function(e){return t.setState({uploadState:{success:!1,message:e}})}))}},{key:"pickFilterFile",value:function(e){var t=this.props,n=t.coeffDir;(0,t.updateFilter)(Ee(n,e)),this.updateDefaults(Ce(n,e),!0)}},{key:"updateDefaults",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.props.filter;ye(a)&&fetch("/api/defaultsforcoeffs?file=".concat(encodeURIComponent(e))).then((function(e){return e.json().then((function(e){var a=e;t.setState({filterDefaults:a,showDefaults:!1}),n&&t.updateFilterParamsWithDefaults(a)}))}))}},{key:"updateFilterParamsWithDefaults",value:function(e){this.props.updateFilter((function(t){var n=e.type?e.type:t.parameters.type,a=ke[t.type][n],r=t.parameters.channel;t.parameters=Object(p.a)(Object(p.a)(Object(p.a)({},a),e),{},{filename:t.parameters.filename}),r&&(t.parameters.channel=r)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.name,a=t.filter,r=this.state.uploadState,i={icon:h.p};return void 0===r||r.success||(i={icon:h.a,className:"error-text",errorMessage:r.message}),c.a.createElement(P,{title:c.a.createElement(G,{style:{width:"300px"},value:n,asString:function(e){return e},parseValue:function(t){return function(t){return n===t||t.trim().length>0&&e.props.isFreeFilterName(t)}(t)?t:void 0},"data-tip":"Filter name, must be unique",onChange:function(t){return e.props.rename(t)}})},c.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},c.a.createElement("div",{className:"vertically-spaced-content",style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},["Biquad","BiquadCombo","Conv","DiffEq"].includes(a.type)&&c.a.createElement(I,{icon:h.f,tooltip:"Plot frequency response of this filter",onClick:this.props.plot}),ye(a)&&c.a.createElement(I,{icon:h.l,tooltip:"Pick filter file",onClick:function(){return e.setState({popupOpen:!0})}}),c.a.createElement(B,{tooltip:"Delete this filter",onClick:this.props.remove})),c.a.createElement(Se,{filter:this.props.filter,errors:this.props.errors,updateFilter:this.props.updateFilter,availableCoeffFiles:this.props.availableCoeffFiles,coeffDir:this.props.coeffDir,filterDefaults:this.state.filterDefaults,showDefaults:this.state.showDefaults,setShowDefaults:function(){return e.setState({showDefaults:!0})}})),c.a.createElement(re,{key:"filter select popup",open:this.state.popupOpen,header:c.a.createElement(c.a.Fragment,null,c.a.createElement(V,{icon:i.icon,className:i.className,tooltip:i.errorMessage?i.errorMessage:"Upload filter files",onChange:this.uploadCoeffs,multiple:!0}),c.a.createElement("div",{style:{margin:"10px 0"}},"For Raw filters, only single channel files are supported.")),items:this.props.availableCoeffFiles,onClose:function(){return e.setState({popupOpen:!1})},onSelect:this.pickFilterFile}))}}]),n}(c.a.Component);function Ce(e,t){return e+t}function Ee(e,t){return function(n){return n.parameters.filename=Ce(e,t)}}var ke={Biquad:{Lowpass:{type:"Lowpass",freq:1e3,q:.5},Highpass:{type:"Highpass",freq:1e3,q:.5},Lowshelf:{type:"Lowshelf",gain:6,freq:1e3,slope:6},Highshelf:{type:"Highshelf",gain:6,freq:1e3,slope:6},LowpassFO:{type:"LowpassFO",freq:1e3},HighpassFO:{type:"HighpassFO",freq:1e3},LowshelfFO:{type:"LowshelfFO",gain:6,freq:1e3},HighshelfFO:{type:"HighshelfFO",gain:6,freq:1e3},Peaking:{type:"Peaking",gain:6,freq:1e3,q:1.5},Notch:{type:"Notch",freq:1e3,q:1.5},Bandpass:{type:"Bandpass",freq:1e3,q:.5},Allpass:{type:"Allpass",freq:1e3,q:.5},AllpassFO:{type:"AllpassFO",freq:1e3},LinkwitzTransform:{type:"LinkwitzTransform",q_act:1.5,q_target:.5,freq_act:50,freq_target:25},Free:{type:"Free",a1:0,a2:0,b0:-1,b1:1,b2:0}},BiquadCombo:{ButterworthLowpass:{type:"ButterworthLowpass",order:2,freq:1e3},ButterworthHighpass:{type:"ButterworthHighpass",order:2,freq:1e3},LinkwitzRileyLowpass:{type:"LinkwitzRileyLowpass",order:2,freq:1e3},LinkwitzRileyHighpass:{type:"LinkwitzRileyHighpass",order:2,freq:1e3}},Conv:{Raw:{type:"Raw",filename:"",format:"TEXT",skip_bytes_lines:0,read_bytes_lines:0},Wav:{type:"Wav",filename:"",channel:0},Values:{type:"Values",values:[1,0,0,0],length:0}},Delay:{Default:{delay:0,unit:"ms",subsample:!1}},Gain:{Default:{gain:0,inverted:!1,mute:!1}},Volume:{Default:{ramp_time:200}},Loudness:{Default:{reference_level:0,high_boost:5,low_boost:5,ramp_time:200}},DiffEq:{Default:{a:[1,0],b:[1,0]}},Dither:{Simple:{type:"Simple",bits:16},Uniform:{type:"Uniform",bits:16,amplitude:1},Lipshitz441:{type:"Lipshitz441",bits:16},Fweighted441:{type:"Fweighted441",bits:16},Shibata441:{type:"Shibata441",bits:16},Shibata48:{type:"Shibata48",bits:16},None:{type:"None",bits:16}}},xe=["skip_bytes_lines","read_bytes_lines"],Se=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).parameterInfos={a:{type:"floatlist",desc:"a",tooltip:"Comma-separated list of coefficients for a"},a1:{type:"float",desc:"a1",tooltip:"Value for Biquad a1 coefficient"},a2:{type:"float",desc:"a2",tooltip:"Value for Biquad a2 coefficient"},amplitude:{type:"float",desc:"amplitude",tooltip:"Dither amplitude relative to target LSB"},b0:{type:"float",desc:"b0",tooltip:"Value for Biquad b0 coefficient"},b:{type:"floatlist",desc:"b",tooltip:"Comma-separated list of coefficients for b"},b1:{type:"float",desc:"b1",tooltip:"Value for Biquad b1 coefficient"},b2:{type:"float",desc:"b2",tooltip:"Value for Biquad b2 coefficient"},bandwidth:{type:"float",desc:"bandwidth",tooltip:"Filter bandwidth in octaves"},bits:{type:"int",desc:"bits",tooltip:"Target bit depth for dither"},channel:{type:"int",desc:"channel",tooltip:"Index of channel to use, starting from 0"},delay:{type:"float",desc:"delay",tooltip:"Delay in ms or samples"},filename:{type:"text",desc:"filename",tooltip:"Filter file name\n           <br/>$samplerate$ will be replaced with the current samplerate\n           <br/>$channels$ will be replaced with the number of channels of the capture device\n          "},format:{type:"enum",desc:"format",options:["S16LE","S24LE","S24LE3","S32LE","FLOAT32LE","FLOAT64LE","TEXT"],tooltip:"Sample format"},freq:{type:"float",desc:"freq",tooltip:"Frequency"},freq_act:{type:"float",desc:"freq_act",tooltip:"Frequency of actual system"},freq_target:{type:"float",desc:"freq_target",tooltip:"Target frequency"},gain:{type:"float",desc:"gain",tooltip:"Gain in dB"},high_boost:{type:"float",desc:"high_boost",tooltip:"Volume boost for high frequencies when volume is at reference_level - 20dB"},inverted:{type:"bool",desc:"inverted",tooltip:"Invert signal"},length:{type:"int",desc:"length",tooltip:"Number of coefficients to generate"},low_boost:{type:"float",desc:"low_boost",tooltip:"Volume boost for low frequencies when volume is at reference_level - 20dB"},mute:{type:"bool",desc:"mute",tooltip:"Mute"},order:{type:"int",desc:"order",tooltip:"Filter order"},q:{type:"float",desc:"Q",tooltip:"Q-value"},q_act:{type:"float",desc:"Q actual",tooltip:"Q-value of actual system"},q_target:{type:"float",desc:"Q target",tooltip:"Target Q-value"},ramp_time:{type:"float",desc:"ramp_time",tooltip:"Volume change ramp time in ms"},read_bytes_lines:{type:"int",desc:"read_bytes_lines",tooltip:"Read up to this number of bytes or lines"},reference_level:{type:"float",desc:"reference_level",tooltip:"Volume level at which low_boost/high_boost is starting to be applied.<br>Boost is scaled up linearly to reach the full value at reference_level - 20dB.<br>Above reference_level only gain is applied."},skip_bytes_lines:{type:"int",desc:"skip_bytes_lines",tooltip:"Number of bytes or lines to skip at beginning of file"},slope:{type:"float",desc:"slope",tooltip:"Filter slope in dB per octave"},subsample:{type:"bool",desc:"subsample",tooltip:"Use subsample precision for delays"},unit:{type:"enum",desc:"unit",options:["ms","samples"],tooltip:"Unit for delay"},values:{type:"floatlist",desc:"values",tooltip:"Comma separated list of filter coefficients"}},r.qBandwithSlope=["q","slope","bandwidth"],r.qAndBandwidthFilters=["Peaking","Allpass","Notch","Bandpass"],r.qAndSlopeFilters=["Lowshelf","Highshelf"],r.defaultParameterValues={q:.5,slope:6,bandwidth:1},r.onTypeChange=r.onTypeChange.bind(Object(i.a)(r)),r.onSubtypeChange=r.onSubtypeChange.bind(Object(i.a)(r)),r.renderFilterParams=r.renderFilterParams.bind(Object(i.a)(r)),r.hasHiddenDefaultValue=r.hasHiddenDefaultValue.bind(Object(i.a)(r)),r.isHiddenDefaultValue=r.isHiddenDefaultValue.bind(Object(i.a)(r)),r.filenameField=r.filenameField.bind(Object(i.a)(r)),r.QorBandwithOrSlope=r.QorBandwithOrSlope.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"onTypeChange",value:function(e){this.props.updateFilter((function(t){t.type=e;var n=ke[e],a=Object.keys(n)[0];t.parameters=m()(n[a])}))}},{key:"onSubtypeChange",value:function(e){this.props.updateFilter((function(t){var n=ye(t)?t.parameters.filename:void 0;t.parameters=m()(ke[t.type][e]),n&&ye(t)&&(t.parameters.filename=n)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.filter,a=t.errors,r=ke[n.type],i=r?Object.keys(r):[];return c.a.createElement("div",{style:{width:"100%",textAlign:"right"}},c.a.createElement($,{message:a({path:[]})}),c.a.createElement(Y,{value:n.type,error:a({path:["type"]}),options:Object.keys(ke),desc:"type","data-tip":"Filter type",onChange:this.onTypeChange}),"Default"!==i[0]&&c.a.createElement(Y,{value:n.parameters.type,error:a({path:["parameters","type"]}),options:i,desc:"subtype","data-tip":"Filter subtype",onChange:this.onSubtypeChange}),c.a.createElement($,{message:a({path:["parameters"]})}),this.renderFilterParams(n.parameters,ge(a,"parameters")),ye(this.props.filter)&&!this.props.showDefaults&&this.hasHiddenDefaultValue()&&c.a.createElement(q,{text:"...",onClick:function(){return e.props.setShowDefaults()}}))}},{key:"renderFilterParams",value:function(e,t){var n=this;return Object.keys(e).map((function(a){if("type"===a)return null;var r=n.parameterInfos[a];if(void 0===r)return console.log("Rendering for filter parameter '".concat(a,"' is not implemented")),null;var i={key:a,value:e[a],error:t({path:[a]}),desc:r.desc,"data-tip":r.tooltip,onChange:function(e){return n.props.updateFilter((function(t){return t.parameters[a]=e}))}};return"filename"===a?n.filenameField(e.filename,i):n.isHiddenDefaultValue(a)?null:!n.qAndSlopeFilters.includes(e.type)&&!n.qAndBandwidthFilters.includes(e.type)||"q"!==a&&"slope"!==a&&"bandwidth"!==a?"text"===r.type?c.a.createElement(te,i):"int"===r.type?c.a.createElement(H,i):"float"===r.type?c.a.createElement(W,i):"bool"===r.type?c.a.createElement(X,i):"floatlist"===r.type?c.a.createElement(Q,i):"enum"===r.type?c.a.createElement(Y,Object.assign({},i,{options:r.options})):null:c.a.createElement(n.QorBandwithOrSlope,Object.assign({},i,{parameter:a,parameters:e,onDescChange:function(e){return n.props.updateFilter((function(t){n.qBandwithSlope.forEach((function(e){delete t.parameters[e]})),t.parameters[e]=n.defaultParameterValues[e]}))}}))}))}},{key:"filenameField",value:function(e,t){var n=this,a=this.props.coeffDir,r=function(e,t){return t.replace(e,"")}(a,e);return c.a.createElement(te,Object.assign({},t,{value:r,onChange:function(e){return n.props.updateFilter(Ee(a,e))}}))}},{key:"hasHiddenDefaultValue",value:function(){var e=this,t=this.props.filterDefaults;return t&&Object.keys(t).some((function(t){return e.isHiddenDefaultValue(t)}))}},{key:"isHiddenDefaultValue",value:function(e){var t=this.props.filter,n=this.props.filterDefaults;return!this.props.showDefaults&&e&&xe.includes(e)&&t.parameters[e]===n[e]}},{key:"QorBandwithOrSlope",value:function(e){var t=this,n=e.parameter,a=e.parameters,r=e.desc,i=e.value,l=e.error,o=e.onDescChange,s=e.onChange,u={};if(this.qAndSlopeFilters.includes(a.type))["q","slope"].forEach((function(e){return u[e]=t.parameterInfos[e].desc}));else{if(!this.qAndBandwidthFilters.includes(a.type))return c.a.createElement($,{message:l});["q","bandwidth"].forEach((function(e){return u[e]=t.parameterInfos[e].desc}))}return c.a.createElement(c.a.Fragment,null,c.a.createElement("label",{className:"setting",style:{textAlign:"right"},"data-tip":e["data-tip"]},c.a.createElement(ee,{value:n,options:u,desc:r,style:{display:"table-cell",width:"min-content",textAlign:"right",marginRight:"5px"},"data-tip":e["data-tip"],onChange:o}),c.a.createElement(J,{className:"setting-input",error:void 0!==l,value:i,style:{width:"55%"},"data-tip":e["data-tip"],onChange:s}),c.a.createElement($,{message:l})))}}]),n}(c.a.Component);function we(e){var t=function(t){return e.updateConfig((function(e){return t(e.devices)}))},n=e.guiConfig,a=e.devices,r=e.errors;return c.a.createElement("div",{className:"tabpanel"},c.a.createElement($,{message:r({path:[]})}),c.a.createElement(Fe,{hide_capture_samplerate:n.hide_capture_samplerate,devices:a,errors:r,onChange:t}),c.a.createElement(Oe,{devices:a,errors:r,onChange:t}),c.a.createElement(je,{hide_silence:n.hide_silence,devices:a,errors:r,onChange:t}),c.a.createElement(Ne,{devices:a,errors:r,onChange:t}),c.a.createElement(De,{hide_capture_samplerate:n.hide_capture_samplerate,devices:a,errors:r,onChange:t}),c.a.createElement(Ae,{hide_rate_monitoring:n.hide_rate_monitoring,devices:a,errors:r,onChange:t}),c.a.createElement(Pe,{hide_capture_device:n.hide_capture_device,capture:a.capture,errors:ge(r,"capture"),onChange:t}),c.a.createElement(Le,{hide_playback_device:n.hide_playback_device,playback:a.playback,errors:ge(r,"playback"),onChange:t}))}function Fe(e){return e.hide_capture_samplerate&&!e.devices.enable_resampling?null:c.a.createElement(_e,{samplerate:e.devices.samplerate,error:e.errors({path:["samplerate"]}),desc:"samplerate","data-tip":"Sample rate for processing and output",onChange:function(t){return e.onChange((function(e){e.samplerate=t}))},extraPadding:!0})}function _e(e){var t=[44100,48e3,88200,96e3,176400,192e3,352800,384e3,705600,768e3];function n(e){return!t.includes(e)}var a=e.samplerate,r=e.extraPadding?"0 12px":"0";return c.a.createElement("div",{className:"setting","data-tip":e["data-tip"],style:{padding:r}},c.a.createElement("label",{htmlFor:e.desc,className:"setting-label"},e.desc),c.a.createElement(ee,{value:n(a)?"Other":a.toString(),options:t.map((function(e){return e.toString()})).concat(["Other"]),desc:e.desc,"data-tip":e["data-tip"],style:{width:n(a)?"40%":"100%"},className:"setting-input",onChange:function(t){var n=parseInt(t),a=isNaN(n)?0:n;e.onChange(a)}}),n(a)&&c.a.createElement(K,{value:a,"data-tip":e["data-tip"],className:"setting-input",style:{width:"60%"},onChange:function(t){return e.onChange(t)}}),c.a.createElement($,{message:e.error}))}function Oe(e){return c.a.createElement(P,{title:"Buffers"},c.a.createElement(H,{value:e.devices.chunksize,error:e.errors({path:["chunksize"]}),desc:"chunksize","data-tip":"Chunksize for the processing",onChange:function(t){return e.onChange((function(e){return e.chunksize=t}))}}),c.a.createElement(H,{value:e.devices.queuelimit,error:e.errors({path:["queuelimit"]}),desc:"queuelimit","data-tip":"Length limit for internal queues",onChange:function(t){return e.onChange((function(e){return e.queuelimit=t}))}}))}function je(e){return e.hide_silence?null:c.a.createElement(P,{title:"Silence"},c.a.createElement(W,{value:e.devices.silence_threshold,error:e.errors({path:["silence_threshold"]}),desc:"silence_threshold","data-tip":"Threshold for silence in dB",onChange:function(t){return e.onChange((function(e){return e.silence_threshold=t}))}}),c.a.createElement(W,{value:e.devices.silence_timeout,error:e.errors({path:["silence_timeout"]}),desc:"silence_timeout","data-tip":"Pause processing after this many seconds of silence",onChange:function(t){return e.onChange((function(e){return e.silence_timeout=t}))}}))}function Ne(e){return["File","Stdout","Pulse"].includes(e.devices.playback.type)?null:c.a.createElement(P,{title:"Rate adjust"},c.a.createElement(X,{value:e.devices.enable_rate_adjust,error:e.errors({path:["enable_rate_adjust"]}),desc:"enable_rate_adjust","data-tip":"Enable rate adjust",onChange:function(t){return e.onChange((function(e){return e.enable_rate_adjust=t}))}}),c.a.createElement(H,{value:e.devices.adjust_period,error:e.errors({path:["adjust_period"]}),desc:"adjust_period","data-tip":"Delay in seconds between rate adjustments",onChange:function(t){return e.onChange((function(e){return e.adjust_period=t}))}}),c.a.createElement(H,{value:e.devices.target_level,error:e.errors({path:["target_level"]}),desc:"target_level","data-tip":"Target output buffer fill level for rate adjust",onChange:function(t){return e.onChange((function(e){return e.target_level=t}))}}))}function De(e){var t=e.devices,n=e.errors;return c.a.createElement(P,{title:"Resampling"},c.a.createElement(X,{value:t.enable_resampling,error:n({path:["enable_resampling"]}),desc:"enable_resampling","data-tip":"Enable rasampling",onChange:function(t){return e.onChange((function(e){return e.enable_resampling=t}))}}),c.a.createElement(Y,{value:t.resampler_type,error:n({path:["resampler_type"]}),options:fe,desc:"resampler_type","data-tip":"Resampler type",onChange:function(t){return e.onChange((function(e){return e.resampler_type=t}))}}),!e.hide_capture_samplerate&&c.a.createElement(_e,{samplerate:t.capture_samplerate,error:n({path:["capture_samplerate"]}),desc:"capture_samplerate","data-tip":"Sample rate for capture device.<br>If different from 'samplerate' then resampling must be enabled",onChange:function(t){return e.onChange((function(e){return e.capture_samplerate=t}))}}))}function Ae(e){return e.hide_rate_monitoring?null:c.a.createElement(P,{title:"Capture rate monitoring"},c.a.createElement(W,{value:e.devices.rate_measure_interval,error:e.errors({path:["rate_measure_interval"]}),desc:"rate_measure_interval","data-tip":"Interval for rate measurements, in seconds",onChange:function(t){return e.onChange((function(e){return e.rate_measure_interval=t}))}}),c.a.createElement(X,{value:e.devices.stop_on_rate_change,error:e.errors({path:["stop_on_rate_change"]}),desc:"stop_on_rate_change","data-tip":"Stop processing when a sample rate change is detected",onChange:function(t){return e.onChange((function(e){return e.stop_on_rate_change=t}))}}))}function Pe(e){if(e.hide_capture_device)return null;var t={Alsa:{type:"Alsa",channels:2,format:"S32LE",device:"hw:0",retry_on_error:!1,avoid_blocking_read:!1},CoreAudio:{type:"CoreAudio",channels:2,format:"FLOAT32LE",device:"blablamac"},Pulse:{type:"Pulse",channels:2,format:"S32LE",device:"something"},Wasapi:{type:"Wasapi",channels:2,format:"FLOAT32LE",device:"blablawin",exclusive:!1,loopback:!1},Jack:{type:"Jack",channels:2,device:"default"},Stdin:{type:"Stdin",channels:2,format:"S32LE",extra_samples:0,skip_bytes:0,read_bytes:0},File:{type:"File",channels:2,format:"S32LE",filename:"/path/to/file",extra_samples:0,skip_bytes:0,read_bytes:0}},n=e.capture,a=e.onChange,r=e.errors;return c.a.createElement(P,{title:"Capture device"},c.a.createElement($,{message:r({path:[]})}),c.a.createElement(Y,{value:n.type,error:r({path:["type"]}),options:Object.keys(t),desc:"type","data-tip":"Audio backend for capture",onChange:function(e){return a((function(n){return n.capture=t[e]}))}}),c.a.createElement(H,{value:n.channels,error:r({path:["channels"]}),desc:"channels","data-tip":"Number of channels",withControls:!0,min:1,onChange:function(e){return a((function(t){return t.capture.channels=e}))}}),"Jack"!==n.type&&c.a.createElement(Y,{value:n.format,error:r({path:["format"]}),options:de,desc:"sampleformat","data-tip":"Sample format",onChange:function(e){return a((function(t){return t.capture.format=e}))}}),("Alsa"===n.type||"CoreAudio"===n.type||"Pulse"===n.type||"Wasapi"===n.type)&&c.a.createElement(te,{value:n.device,error:r({path:["device"]}),desc:"device","data-tip":"Name of device",onChange:function(e){return a((function(t){return t.capture.device=e}))}}),"Alsa"===n.type&&c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{value:n.retry_on_error,error:r({path:["device"]}),desc:"retry_on_error","data-tip":"Retry reading from device on errors, may help with buggy devices",onChange:function(e){return a((function(t){return t.capture.retry_on_error=e}))}}),c.a.createElement(X,{value:n.avoid_blocking_read,error:r({path:["device"]}),desc:"avoid_blocking_read","data-tip":"Avoid blocking on reads, may help with buggy devices",onChange:function(e){return a((function(t){return t.capture.avoid_blocking_read=e}))}})),"Wasapi"===n.type&&c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{value:n.exclusive,error:r({path:["exclusive"]}),desc:"exclusive","data-tip":"Use exclusive mode",onChange:function(e){return a((function(t){return t.capture.exclusive=e}))}}),c.a.createElement(X,{value:n.loopback,error:r({path:["loopback"]}),desc:"loopback","data-tip":"Use loopback capture mode to capture from a playback device",onChange:function(e){return a((function(t){return t.capture.loopback=e}))}})),"File"===n.type&&c.a.createElement(te,{value:n.filename,error:r({path:["filename"]}),desc:"filename","data-tip":"Filename including path",onChange:function(e){return a((function(t){return t.capture.filename=e}))}}),("File"===n.type||"Stdin"===n.type)&&c.a.createElement(c.a.Fragment,null,c.a.createElement(H,{value:n.extra_samples,error:r({path:["extra_samples"]}),desc:"extra_samples","data-tip":"Number of extra samples to insert after end of file",onChange:function(e){return a((function(t){return t.capture.extra_samples=e}))}}),c.a.createElement(H,{value:n.skip_bytes,error:r({path:["skip_bytes"]}),desc:"skip_bytes","data-tip":"Number of bytes to skip at beginning of file",onChange:function(e){return a((function(t){return t.capture.skip_bytes=e}))}}),c.a.createElement(H,{value:n.read_bytes,error:r({path:["read_bytes"]}),desc:"read_bytes","data-tip":"Read up to this number of bytes",onChange:function(e){return a((function(t){return t.capture.read_bytes=e}))}})))}function Le(e){if(e.hide_playback_device)return null;var t={Alsa:{type:"Alsa",channels:2,format:"S32LE",device:"hw:0"},CoreAudio:{type:"CoreAudio",channels:2,format:"FLOAT32LE",device:"blablamac"},Pulse:{type:"Pulse",channels:2,format:"S32LE",device:"something"},Wasapi:{type:"Wasapi",channels:2,format:"FLOAT32LE",device:"blablawin",exclusive:!1},Jack:{type:"Jack",channels:2,device:"default"},Stdout:{type:"Stdout",channels:2,format:"S32LE"},File:{type:"File",channels:2,format:"S32LE",filename:"/path/to/file"}},n=e.onChange,a=e.playback,r=e.errors;return c.a.createElement(P,{title:"Playback device"},c.a.createElement($,{message:r({path:[]})}),c.a.createElement(Y,{value:e.playback.type,error:r({path:["type"]}),options:Object.keys(t),"data-tip":"Audio backend for playback",desc:"type",onChange:function(n){return e.onChange((function(e){return e.playback=t[n]}))}}),c.a.createElement(H,{value:a.channels,error:r({path:["channels"]}),desc:"channels","data-tip":"Number of channels",withControls:!0,min:1,onChange:function(e){return n((function(t){return t.playback.channels=e}))}}),"Jack"!==a.type&&c.a.createElement(Y,{value:a.format,error:r({path:["format"]}),options:de,desc:"sampleformat","data-tip":"Sample format",onChange:function(e){return n((function(t){return t.playback.format=e}))}}),("Alsa"===a.type||"CoreAudio"===a.type||"Pulse"===a.type||"Wasapi"===a.type)&&c.a.createElement(te,{value:a.device,error:r({path:["device"]}),desc:"device","data-tip":"Name of device",onChange:function(e){return n((function(t){return t.playback.device=e}))}}),"Wasapi"===a.type&&c.a.createElement(X,{value:a.exclusive,error:r({path:["device"]}),desc:"exclusive","data-tip":"Use exclusive mode",onChange:function(e){return n((function(t){return t.playback.exclusive=e}))}}),"File"===a.type&&c.a.createElement(te,{value:a.filename,error:r({path:["filename"]}),desc:"filename","data-tip":"Filename including path",onChange:function(e){return n((function(t){return t.playback.filename=e}))}}))}var qe=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).mixerNames=r.mixerNames.bind(Object(i.a)(r)),r.addMixer=r.addMixer.bind(Object(i.a)(r)),r.renameMixer=r.renameMixer.bind(Object(i.a)(r)),r.removeMixer=r.removeMixer.bind(Object(i.a)(r)),r.isFreeMixerName=r.isFreeMixerName.bind(Object(i.a)(r)),r.state={mixerKeys:{}},r.mixerNames().forEach((function(e,t){return r.state.mixerKeys[e]=t})),r}return Object(r.a)(n,[{key:"mixerNames",value:function(){return se(this.props.mixers)}},{key:"addMixer",value:function(){var e=this;this.props.updateConfig((function(t){var n=oe("New Mixer ",se(t.mixers));e.setState((function(e){return S(e,(function(t){return t.mixerKeys[n]=1+Math.max.apply(Math,[0].concat(Object(f.a)(Object.values(e.mixerKeys))))}))})),t.mixers[n]={channels:{in:2,out:2},mapping:[ce(2,[])]}}))}},{key:"removeMixer",value:function(e){var t=this;this.props.updateConfig((function(n){!function(e,t){delete e.mixers[t];var n=e.pipeline;e.pipeline=n.filter((function(e){return"Mixer"!==e.type||e.name!==t}))}(n,e),t.setState((function(t){return S(t,(function(t){return delete t.mixerKeys[e]}))}))}))}},{key:"renameMixer",value:function(e,t){var n=this;this.isFreeMixerName(t)&&this.props.updateConfig((function(a){n.setState((function(n){return S(n,(function(n){n.mixerKeys[t]=n.mixerKeys[e],delete n.mixerKeys[e]}))})),function(e,t,n){if(se(e).includes(n))throw new Error("Mixer '".concat(n,"' already exists"));e.mixers[n]=e.mixers[t],delete e.mixers[t];var a,r=Object(g.a)(e.pipeline);try{for(r.s();!(a=r.n()).done;){var i=a.value;"Mixer"===i.type&&i.name===t&&(i.name=n)}}catch(l){r.e(l)}finally{r.f()}}(a,e,t)}))}},{key:"isFreeMixerName",value:function(e){return!this.mixerNames().includes(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.mixers,a=t.errors,r=t.updateConfig;return c.a.createElement("div",{className:"tabpanel"},c.a.createElement($,{message:a({path:[]})}),this.mixerNames().map((function(t){return c.a.createElement(Te,{key:e.state.mixerKeys[t],name:t,mixer:n[t],errors:ge(a,t),update:function(e){return r((function(n){return e(n.mixers[t])}))},isFreeMixerName:e.isFreeMixerName,rename:function(n){return e.renameMixer(t,n)},remove:function(){return e.removeMixer(t)}})})),c.a.createElement("div",null,c.a.createElement(T,{tooltip:"Add a new mixer",onClick:this.addMixer})))}}]),n}(c.a.Component);function Te(e){var t=e.name,n=e.mixer,a=e.errors,r=e.rename,i=e.remove,l=e.update,o=function(n){return t===n||n.trim().length>0&&e.isFreeMixerName(n)};return c.a.createElement(P,{title:c.a.createElement(c.a.Fragment,null,c.a.createElement(G,{value:t,style:{width:"300px"},"data-tip":"Mixer name, must be unique",onChange:r,asString:function(e){return e},parseValue:function(e){return o(e)?e:void 0}}),c.a.createElement(B,{tooltip:"Delete this mixer",smallButton:!0,onClick:i}))},c.a.createElement($,{message:a({path:[]})}),c.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},c.a.createElement(H,{value:n.channels.in,desc:"in","data-tip":"Number of channels in",small:!0,withControls:!0,min:1,onChange:function(e){return l((function(t){return t.channels.in=e}))}}),c.a.createElement(H,{value:n.channels.out,desc:"out","data-tip":"Number of channels out",small:!0,withControls:!0,min:1,onChange:function(e){return l((function(t){return t.channels.out=e}))}})),c.a.createElement($,{message:a({path:["channels"]})}),c.a.createElement($,{message:a({path:["channels","in"]})}),c.a.createElement($,{message:a({path:["channels","out"]})}),n.mapping.map((function(e,t){return c.a.createElement(Be,{key:t,mapping:e,errors:ge(a,"mapping",t),channels:n.channels,update:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return l((function(n){return e(n.mapping[t])}))})),remove:function(){return l((function(e){return e.mapping.splice(t,1)}))}})})),c.a.createElement("div",null,n.mapping.length<n.channels.out&&c.a.createElement(T,{tooltip:"Add a mapping",style:{marginTop:"10px"},onClick:function(){return l((function(e){return e.mapping.push(ce(e.channels.out,e.mapping))}))}})))}function Be(e){var t=e.mapping,n=e.errors,a=e.channels,r=e.remove,i=e.update;return c.a.createElement(P,{style:{marginTop:"5px"},title:c.a.createElement(c.a.Fragment,null,c.a.createElement(H,{value:t.dest,desc:"dest","data-tip":"Destination channel",small:!0,withControls:!0,min:0,max:a.out-1,onChange:function(e){return i((function(t){return t.dest=e}))}}),c.a.createElement(I,{icon:h.r,tooltip:"Mute destination channel",smallButton:!0,className:t.mute?"highlighted-button":"",onClick:function(){return i((function(e){return e.mute=!e.mute}))}}),c.a.createElement(B,{tooltip:"Delete this mapping",smallButton:!0,onClick:r}))},c.a.createElement($,{message:n({path:["dest"]})}),c.a.createElement($,{message:n({path:["mute"]})}),c.a.createElement($,{message:n({path:[]})}),c.a.createElement($,{message:n({path:["sources"]})}),c.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},t.sources.map((function(e,r){return c.a.createElement(c.a.Fragment,{key:r},c.a.createElement(Me,{source:e,errors:ge(n,"sources",r),channelsIn:a.in,update:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return i((function(t){return e(t.sources[r])}))})),remove:function(){return i((function(e){return e.sources.splice(r,1)}))}}),r+1<t.sources.length&&c.a.createElement("hr",null))})),c.a.createElement("div",null,c.a.createElement(T,{tooltip:"Add a source to this mapping",onClick:function(){return i((function(e){return e.sources.push(ue(a.in,e.sources))}))}}))))}function Me(e){var t=e.source,n=e.errors,a=e.channelsIn,r=e.update,i=e.remove;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"horizontally-spaced-content"},c.a.createElement("div",{style:{flexGrow:1}},c.a.createElement(H,{value:t.channel,desc:"channel","data-tip":"Channel number",small:!0,withControls:!0,min:0,max:a-1,onChange:function(e){return r((function(t){return t.channel=e}))}})),c.a.createElement("div",{style:{flexGrow:1}},c.a.createElement(H,{value:t.gain,desc:"gain","data-tip":"Gain in dB",small:!0,onChange:function(e){return r((function(t){return t.gain=e}))}})),c.a.createElement(I,{icon:h.m,tooltip:"Invert source channel",smallButton:!0,className:t.inverted?"highlighted-button":"",onClick:function(){return r((function(e){return e.inverted=!e.inverted}))}}),c.a.createElement(I,{icon:h.r,tooltip:"Mute source channel",smallButton:!0,className:t.mute?"highlighted-button":"",onClick:function(){return r((function(e){return e.mute=!e.mute}))}}),c.a.createElement(B,{tooltip:"Delete this source",smallButton:!0,onClick:i})),c.a.createElement($,{message:n({path:[],includeChildren:!0})}))}var Ve=n(19);function Ie(e){return c.a.createElement(k.a,{open:e.open,closeOnDocumentClick:!0,onClose:e.onClose,contentStyle:{width:"80%"}},c.a.createElement(R,{onClick:e.onClose}),c.a.createElement(ze,{config:e.config}))}var ze=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))).width=1e3,e.height=500,e.textColor=void 0,e.borderColor=void 0,e.arrowColor=void 0,e.backgroundColor=void 0,e.frameBgColor=void 0,e.blockBgColor=void 0,e.blockTextColor=void 0,e.node=void 0,e}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=j();this.textColor=e.getPropertyValue("--text-color"),this.borderColor=e.getPropertyValue("--box-border-color"),this.arrowColor=e.getPropertyValue("--arrow-color"),this.backgroundColor=e.getPropertyValue("--background-color"),this.frameBgColor=e.getPropertyValue("--frame-background-color"),this.blockBgColor=e.getPropertyValue("--block-background-color"),this.blockTextColor=e.getPropertyValue("--block-text-color"),this.createPipelinePlot()}},{key:"componentDidUpdate",value:function(){this.createPipelinePlot()}},{key:"appendBlock",value:function(e,t,n,a,r,i){var l={x:a-.5*i,y:r-.35,width:i,height:.7,fill:this.blockBgColor,stroke:this.borderColor,"stroke-width":1},o={x:a,y:r+.1,text:n,fill:this.blockTextColor,size:.3,angle:0};return e.push(o),t.push(l),{output:{x:a+.5*i,y:r},input:{x:a-.5*i,y:r}}}},{key:"appendFrame",value:function(e,t,n,a,r,i,l){var o={x:a-.5*i,y:-l/2+r,width:i,height:l,fill:this.frameBgColor,stroke:this.borderColor,"stroke-width":1},s={x:a,y:-l/2-.2+r,text:n,fill:this.textColor,size:.3,angle:0};e.push(s),t.push(o)}},{key:"appendLink",value:function(e,t,n,a,r){var i={source:[n.x,n.y],target:[a.x,a.y]};if(r){var l=a.y<=n.y?{x:2*n.x/3+a.x/3,y:2*n.y/3+a.y/3}:{x:n.x/3+2*a.x/3,y:n.y/3+2*a.y/3},o=Object(p.a)(Object(p.a)({},l),{},{text:r,fill:this.textColor,size:.2,angle:270/3.14*Math.atan((a.y-n.y)/(a.x-n.x))});t.push(o)}e.push(i)}},{key:"makeShapes",value:function(e){var t,a=[],r=[],i=[],l=[],o=[],s=e.devices.capture,c=s.channels,u=n.deviceText(s);this.appendFrame(a,r,u,0,0,1.5,1*c);for(var p=0;p<c;p++){var f="ch "+p,d=this.appendBlock(a,r,f,0,1*(-c/2+.5+p),1);o.push([d])}l.push(o),t=c/2+1;for(var m=0,h=0,g=0;g<e.pipeline.length;g++){var v=e.pipeline[g];if("Mixer"===v.type){m+=1;var y=v.name,b=e.mixers[y];c=b.channels.out;var C=[];this.appendFrame(a,r,y,3*m,0,1.5,1*c);for(var E=0;E<c;E++){C.push([]);var k="ch "+E,x=this.appendBlock(a,r,k,3*m,1*(-c/2+.5+E),1);C[E].push(x)}for(var S=0;S<b.mapping.length;S++)for(var w=b.mapping[S],F=w.dest,_=0;_<w.sources.length;_++){var O=w.sources[_],j=O.channel,N=O.gain+" dB"+(O.inverted?" inv.":""),D=l[l.length-1][j].length,A=l[l.length-1][j][D-1].output,P=C[F][0].input;this.appendLink(i,a,A,P,N)}l.push(C),h=m,t=Math.max(t,c/2+1)}else if("Filter"===v.type)for(var L=v.channel,q=0;q<v.names.length;q++){var T=v.names[q],B=h+l[l.length-1][L].length;m=Math.max(m,B);var M=this.appendBlock(a,r,T,3*B,1*(-c/2+.5+L),2.5),V=l[l.length-1][L],I=V[V.length-1].output,z=M.input;l[l.length-1][L].push(M),this.appendLink(i,a,I,z)}}var R=[],U=3*((m+=1)+1),H=n.deviceText(e.devices.playback);this.appendFrame(a,r,H,3*m,0,1.5,1*c);for(var K=0;K<c;K++){var W="ch "+K,J=this.appendBlock(a,r,W,3*m,1*(-c/2+.5+K),1);R.push([J]);var Q=l[l.length-1][K].length,G=l[l.length-1][K][Q-1].output,Z=J.input;this.appendLink(i,a,G,Z)}return l.push(R),{labels:a,boxes:r,links:i,max_h:U,max_v:t}}},{key:"createPipelinePlot",value:function(){var e=this.makeShapes(this.props.config),t=e.labels,n=e.boxes,a=e.links,r=e.max_h,i=e.max_v;r>4*i?i=r/4:r=4*i;var l=this.node,o=Ve.c().domain([-i,i]).range([0,this.height]),s=Ve.c().domain([-2,r]).range([0,this.width]),c=Ve.b().source((function(e){return[s(e.source[0]),o(e.source[1])]})).target((function(e){return[s(e.target[0]),o(e.target[1])]})),u=[[0,0],[0,7],[7,3.5]];Ve.d(l).append("defs").append("marker").attr("id","arrow").attr("viewBox",[0,0,7,7]).attr("refX",7).attr("refY",3.5).attr("markerWidth",7).attr("markerHeight",7).attr("orient","auto-start-reverse").attr("fill",this.arrowColor).attr("stroke",this.arrowColor).append("path").attr("d",Ve.a()(u)),Ve.d(l).selectAll("rect").data(n).enter().append("rect").attr("x",(function(e){return s(e.x)})).attr("y",(function(e){return o(e.y)})).attr("rx",s(.1)-s(0)).attr("ry",o(.1)-o(0)).attr("width",(function(e){return s(e.width)-s(0)})).attr("height",(function(e){return o(e.height)-o(0)})).style("fill",(function(e){return e.fill})).style("stroke",(function(e){return e.stroke})).style("stroke-width",(function(e){return e["stroke-width"]})),Ve.d(l).selectAll("text").data(t).enter().append("text").text((function(e){return e.text})).attr("font-size",(function(e){return o(e.size)-o(0)+"px"})).attr("fill",(function(e){return e.fill})).style("text-anchor","middle").attr("transform",(function(e){return"translate(".concat(s(e.x),",").concat(o(e.y),"), rotate(").concat(e.angle,")")})).attr("font-family","sans-serif"),Ve.d(l).selectAll(null).data(a).join("path").attr("d",c).attr("marker-end","url(#arrow)").attr("fill","none").attr("stroke",this.arrowColor)}},{key:"render",value:function(){var e=this;return c.a.createElement("svg",{ref:function(t){return e.node=t},viewBox:"0 0 ".concat(this.width," ").concat(this.height),style:{width:"100%",height:"auto"}})}}],[{key:"deviceText",value:function(e){return"device"in e?e.device:"filename"in e?e.filename:e.type}}]),n}(c.a.Component),Re=n(83),Ue=n(310),He=n(312),Ke=n(313),We=n(34),Je=n.n(We),Qe=n(123);function Ge(e){return c.a.createElement(Ue.a,{backend:Qe.a},e.children)}function Ze(e,t,n){var a=Object(He.a)((function(){return{type:e,item:t,options:{dropEffect:"move"},collect:function(e){return{isDragging:e.isDragging()}}}})),r=Object(Re.a)(a,3),i=r[0].isDragging,l=r[1],o=r[2],s=Object(Ke.a)((function(){return{accept:e,collect:function(e){return{canDrop:e.isOver()&&!Je()(e.getItem(),t)}},drop:function(e){return n(e,t)}}})),c=Object(Re.a)(s,2);return{isDragging:i,canDrop:c[0].canDrop,drag:l,preview:o,drop:c[1]}}function $e(e){var t=e.isDragging,n=e.canDrop,a=e.preview,r=e.drop,i=e.children;return c.a.createElement("div",{ref:a,className:"dropTargetParent",style:{width:"100%"}},c.a.createElement("div",{ref:r,style:{width:"100%"},className:"horizontally-spaced-content".concat(t?" dragSource":"").concat(n?" dropTarget":"")},i))}function Xe(e){return c.a.createElement("span",{ref:e.drag,style:{display:"flex",alignItems:"center"}},c.a.createElement(E.a,{path:h.k,size:"24px",className:"drag-handle","data-tip":e.tooltip}))}var Ye=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).updatePipeline=function(e){return r.props.updateConfig((function(t){return e(t.pipeline)}))},r.addStep=function(){return r.updatePipeline((function(e){return e.push(pe(r.props.config))}))},r.removeStep=function(e){return r.updatePipeline((function(t){return t.splice(e,1)}))},r.setStepType=function(e,t){return r.updatePipeline((function(n){"Mixer"===t?n[e]=function(e){var t=se(e);return{type:"Mixer",name:1===t.length?t[0]:""}}(r.props.config):"Filter"===t&&(n[e]=pe(r.props.config))}))},r.plotFilterStep=function(e){fetch("/api/evalfilterstep",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:e,config:r.props.config})}).then((function(e){return e.json().then((function(e){return r.setState({plotFilterStep:!0,data:e})}))}),(function(e){return console.log("Failed",e)}))},r.moveStepUp=function(e){return r.updatePipeline((function(t){return F(t,e)}))},r.moveStepDown=function(e){return r.updatePipeline((function(t){return _(t,e)}))},r.state={plotPipeline:!1,plotFilterStep:!1},r}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props.errors,n=this.props.config.pipeline;return c.a.createElement(Ge,null,c.a.createElement("div",{className:"tabpanel"},c.a.createElement($,{message:t({path:[]})}),c.a.createElement("div",{className:"pipeline-channel"},"Capture: ",this.props.config.devices.capture.channels," channels in"),n.map((function(a,r){var i=ge(t,r),l=c.a.createElement(ee,{value:a.type,options:["Mixer","Filter"],desc:"type","data-tip":"Step type, Mixer or Filter",onChange:function(t){return e.setStepType(r,t)}}),o=c.a.createElement(c.a.Fragment,null,c.a.createElement(B,{tooltip:"Delete this step",onClick:function(){return e.removeStep(r)}}),c.a.createElement(I,{icon:h.e,tooltip:"Move this step up",enabled:r>0,onClick:function(){return e.moveStepUp(r)}}),c.a.createElement(I,{icon:h.d,tooltip:"Move this step down",enabled:r+1<n.length,onClick:function(){return e.moveStepDown(r)}}));return"Filter"===a.type?c.a.createElement(nt,{key:r,stepIndex:r,typeSelect:l,filterStep:a,filters:e.props.config.filters,updatePipeline:e.updatePipeline,plot:function(){return e.plotFilterStep(r)},errors:i,controls:o}):"Mixer"===a.type?c.a.createElement(tt,{key:r,stepIndex:r,typeSelect:l,mixerStep:a,mixers:e.props.config.mixers,updatePipeline:e.updatePipeline,errors:i,controls:o}):null})),c.a.createElement("div",{className:"horizontally-spaced-content"},c.a.createElement(T,{tooltip:"Add a pipeline step",onClick:this.addStep}),c.a.createElement(M,{tooltip:"Plot the pipeline",onClick:function(){return e.setState({plotPipeline:!0})}})),c.a.createElement("div",{className:"pipeline-channel"},"Playback: ",this.props.config.devices.playback.channels," channels out"),c.a.createElement(Ie,{key:this.state.plotPipeline,open:this.state.plotPipeline,config:this.props.config,onClose:function(){return e.setState({plotPipeline:!1})}}),this.state.plotFilterStep&&c.a.createElement(ae,{key:this.state.plotFilterStep,open:this.state.plotFilterStep,data:this.state.data,onClose:function(){return e.setState({plotFilterStep:!1})}})))}}]),n}(c.a.Component);function et(e,t){return Ze("step",{stepIndex:e},(function(e,n){var a=e.stepIndex,r=n.stepIndex;return t((function(e){return O(e,a,r)}))}))}function tt(e){var t=e.stepIndex,n=e.typeSelect,a=e.mixers,r=e.mixerStep,i=e.updatePipeline,l=e.controls,o=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return i((function(n){return e(n[t])}))})),s=a[r.name],u=s?"".concat(s.channels.in," in, ").concat(s.channels.out," out"):"",p=[""].concat(se(a)),f=e.errors({path:["name"]}),d=et(t,i);return c.a.createElement($e,d,c.a.createElement(P,{title:c.a.createElement(c.a.Fragment,null,c.a.createElement(Xe,{drag:d.drag,tooltip:"Drag mixer to sort"}),c.a.createElement("label",null,n,"\xa0\xa0\xa0\xa0",u))},c.a.createElement("div",{className:"vertically-spaced-content"},c.a.createElement($,{message:e.errors({path:[]})}),c.a.createElement($,{message:e.errors({path:["type"]})}),c.a.createElement(ee,{value:r.name,options:p,desc:"name","data-tip":"Mixer name",style:f?Z:void 0,onChange:function(e){return o((function(t){return t.name=e}))}}),c.a.createElement($,{message:f}),c.a.createElement("div",{className:"horizontally-spaced-content"},l))))}function nt(e){var t=e.stepIndex,n=e.typeSelect,a=e.filterStep,r=e.filters,i=e.updatePipeline,l=e.plot,o=e.controls,s=[""].concat(ie(r)),u=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return i((function(n){return e(n[t])}))})),p=function(e,t,n,a){return u((function(r){e===n?O(r.names,t,a):i((function(r){var i,l=r[e].names.splice(t,1);(i=r[n].names).splice.apply(i,[a,0].concat(Object(f.a)(l)))}))}))},d=et(t,i),m=c.a.createElement(c.a.Fragment,null,c.a.createElement(Xe,{drag:d.drag,tooltip:"Drag filter step to sort"}),n,"\xa0\xa0\xa0\xa0",c.a.createElement("label",{"data-tip":"Channel number"},"channel",c.a.createElement(K,{className:"small-setting-input",style:{marginLeft:"5px"},value:a.channel,"data-tip":"Channel number",withControls:!0,min:0,onChange:function(e){return u((function(t){return t.channel=e}))}})));return c.a.createElement($e,d,c.a.createElement(P,{title:m},c.a.createElement("div",{className:"vertically-spaced-content"},c.a.createElement($,{message:e.errors({path:["type"]})}),c.a.createElement($,{message:e.errors({path:["channel"]})}),c.a.createElement($,{message:e.errors({path:[]})}),c.a.createElement("div",{className:"vertically-spaced-content"},a.names.map((function(n,r){return c.a.createElement(at,{stepIndex:t,key:r,index:r,name:n,options:s,setName:function(e){return u((function(t){return t.names[r]=e}))},moveFilter:p,errors:e.errors({path:["names",r]}),controls:c.a.createElement(c.a.Fragment,null,c.a.createElement(I,{icon:h.e,tooltip:"Move filter up",smallButton:!0,enabled:r>0,onClick:function(){return function(e){return u((function(t){return F(t.names,e)}))}(r)}}),c.a.createElement(I,{icon:h.d,tooltip:"Move filter down",smallButton:!0,enabled:r+1<a.names.length,onClick:function(){return function(e){return u((function(t){return _(t.names,e)}))}(r)}}),c.a.createElement(B,{tooltip:"Remove this filter from the list",smallButton:!0,onClick:function(){return u((function(e){return e.names.splice(r,1)}))}}))})}))),c.a.createElement($,{message:e.errors({path:["names"]})}),c.a.createElement("div",{className:"horizontally-spaced-content"},o,c.a.createElement(T,{tooltip:"Add a filter to the list",onClick:function(){return u((function(e){return e.names.push(s[0])}))}}),c.a.createElement(M,{tooltip:"Plot response of this step",onClick:l})))))}function at(e){var t=e.stepIndex,n=e.index,a=e.options,r=e.name,i=e.setName,l=e.moveFilter,o=e.errors,s=e.controls,u=Ze("filter",{stepIndex:t,index:n},(function(e,t){var n=e.stepIndex,a=e.index,r=t.stepIndex,i=t.index;return l(n,a,r,i)})),f=u.isDragging,d=u.canDrop,m=u.drag,h=u.preview,g=u.drop;return c.a.createElement($e,{isDragging:f,canDrop:d,drag:m,preview:h,drop:g},c.a.createElement("div",{className:"horizontally-spaced-content"},c.a.createElement(Xe,{drag:m,tooltip:"Drag filter to sort"}),c.a.createElement(ee,{value:r,options:a,desc:"step".concat(t,"-filter").concat(n),"data-tip":"Filter name",style:Object(p.a)({width:"100%"},o?Z:{}),onChange:i}),s),c.a.createElement($,{message:o}))}var rt=n(14),it=n(40),lt=n(58);function ot(e){return c.a.createElement("div",{className:"tabpanel"},c.a.createElement(st,{title:"Configs",type:"config",currentConfigFile:e.currentConfigFile,config:e.config,setCurrentConfig:e.setCurrentConfig}),c.a.createElement(st,{title:"Filters",type:"coeff"}))}var st=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).type=r.props.type,r.canLoadAndSave="config"===r.type,r.update=r.update.bind(Object(i.a)(r)),r.loadActiveConfig=r.loadActiveConfig.bind(Object(i.a)(r)),r.setActiveConfig=r.setActiveConfig.bind(Object(i.a)(r)),r.toggleAllFileSelection=r.toggleAllFileSelection.bind(Object(i.a)(r)),r.toggleFileSelection=r.toggleFileSelection.bind(Object(i.a)(r)),r.areAllFilesSelected=r.areAllFilesSelected.bind(Object(i.a)(r)),r.upload=r.upload.bind(Object(i.a)(r)),r.delete=r.delete.bind(Object(i.a)(r)),r.downloadAsZip=r.downloadAsZip.bind(Object(i.a)(r)),r.overwriteConfig=r.overwriteConfig.bind(Object(i.a)(r)),r.saveConfig=r.saveConfig.bind(Object(i.a)(r)),r.loadConfig=r.loadConfig.bind(Object(i.a)(r)),r.showErrorMessage=r.showErrorMessage.bind(Object(i.a)(r)),r.state={files:[],selectedFiles:Object(lt.a)(),activeConfigFileName:"",newFileName:"New config.yml",fileStatus:null,stopTimer:function(){}},r}return Object(r.a)(n,[{key:"componentDidUpdate",value:function(){it.a.rebuild()}},{key:"componentDidMount",value:function(){this.update();var e=setInterval(this.update,1e3);this.setState({stopTimer:function(){return clearInterval(e)}}),this.loadActiveConfig()}},{key:"componentWillUnmount",value:function(){this.state.stopTimer()}},{key:"update",value:function(){var e=this;fetch("/api/stored".concat(this.type,"s")).then((function(e){return e.json()})).then((function(t){return e.setState((function(e){var n=t;return{files:n,selectedFiles:e.selectedFiles.intersect(n)}}))}))}},{key:"delete",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Delete?\n"+this.state.selectedFiles.join("\n"))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,fetch("/api/delete".concat(this.type,"s"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.state.selectedFiles)});case 5:this.setState({fileStatus:null}),this.update();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"downloadAsZip",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/download".concat(this.type,"szip"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.state.selectedFiles)});case 2:return t=e.sent,e.next=5,t.blob();case 5:n=e.sent,N(this.type+"s.zip",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(e){var t=this;D(this.type,e,(function(){t.setState({fileStatus:{filename:"",action:"upload",success:!0}}),t.update()}),(function(e){return t.setState({fileStatus:{filename:"",action:"upload",success:!1,statusText:e}})}))}},{key:"loadConfig",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/getconfigfile?name=".concat(encodeURIComponent(t)));case 3:if((n=e.sent).ok){e.next=12;break}return e.t0=this,e.t1=t,e.next=9,n.text();case 9:return e.t2=e.sent,e.t0.showErrorMessage.call(e.t0,e.t1,"load",e.t2),e.abrupt("return");case 12:return e.next=14,n.json();case 14:a=e.sent,this.props.setCurrentConfig(t,a),this.setState({fileStatus:{filename:t,action:"load",success:!0}}),e.next=22;break;case 19:e.prev=19,e.t3=e.catch(0),this.showErrorMessage(t,"load",e.t3);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showErrorMessage",value:function(e,t,n){this.setState({fileStatus:{filename:e,action:t,success:!1,statusText:n}})}},{key:"loadActiveConfig",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct();case 2:t=e.sent,this.setState({activeConfigFileName:t.configFileName});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setActiveConfig",value:function(e){var t=this;fetch("/api/setactiveconfigfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}).then((function(){return t.loadActiveConfig()}))}},{key:"overwriteConfig",value:function(e){window.confirm("Overwrite?\n"+e)&&this.saveConfig(e)}},{key:"saveConfig",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,a,r,i,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,a=n.config,r=n.setCurrentConfig,e.prev=1,e.next=4,fetch("/api/saveconfigfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:t,config:a})});case 4:if(!(i=e.sent).ok){e.next=11;break}r(t,a),this.setState({fileStatus:{filename:t,action:"save",success:!0}}),this.update(),e.next=15;break;case 11:return e.next=13,i.text();case 13:l=e.sent,this.showErrorMessage(t,"save",l);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),this.showErrorMessage(t,"save",e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleAllFileSelection",value:function(){var e=this;this.setState((function(t){var n=t.files,a=e.areAllFilesSelected()?Object(lt.a)():Object(lt.a)(n);return Object.assign({},t,{selectedFiles:a})}))}},{key:"toggleFileSelection",value:function(e){this.setState((function(t){var n=t.selectedFiles,a=n.has(e)?n.delete(e):n.add(e);return Object.assign({},t,{selectedFiles:a})}))}},{key:"areAllFilesSelected",value:function(){var e=this.state,t=e.files,n=e.selectedFiles;return t.length>1&&n.isSuperset(t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.files,a=t.selectedFiles,r=t.fileStatus,i=t.newFileName,l=t.activeConfigFileName;return c.a.createElement(P,{title:this.props.title},c.a.createElement("div",{style:{display:"grid",alignItems:"center",gridTemplateColumns:"min-content min-content min-content min-content 100%",gap:"5px 5px"}},c.a.createElement(ut,{filename:"all files",checked:this.areAllFilesSelected(),onChange:this.toggleAllFileSelection}),c.a.createElement(pt,{selectedFiles:a,downloadAsZip:this.downloadAsZip}),c.a.createElement(ft,{selectedFiles:a,delete:this.delete}),c.a.createElement(dt,{fileStatus:r,upload:this.upload}),c.a.createElement("div",null,c.a.createElement(yt,{filename:"",fileStatus:r})),n.flatMap((function(t){return[c.a.createElement(ut,{key:t+"(1)",filename:t,checked:a.has(t),onChange:function(){return e.toggleFileSelection(t)}}),e.canLoadAndSave?c.a.createElement(mt,{key:t+"(2)",active:t===l,onClick:function(){return e.setActiveConfig(t)}}):null,e.canLoadAndSave?c.a.createElement(ht,{key:t+"(3)",filename:t,fileStatus:r,saveConfig:e.overwriteConfig}):null,e.canLoadAndSave?c.a.createElement(gt,{key:t+"(4)",filename:t,fileStatus:r,loadConfig:e.loadConfig}):null,c.a.createElement("div",{key:t+"(5)",style:e.canLoadAndSave?{}:{gridColumn:"2 / span 4"}},c.a.createElement(vt,{type:e.type,filename:t,isCurrentConfig:e.props.currentConfigFile===t}),c.a.createElement(yt,{filename:t,fileStatus:r}))]})),this.canLoadAndSave&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement(ht,{disableReason:bt(i,n),filename:i,fileStatus:r,saveConfig:this.saveConfig}),c.a.createElement("div",null),c.a.createElement("div",null,c.a.createElement("input",{type:"text",value:i,"data-tip":"Enter a name for the new config file",onChange:function(t){return e.setState({newFileName:t.target.value})}}),c.a.createElement(yt,{filename:i,fileStatus:r})))))}}]),n}(s.Component);function ct(){return fetch("/api/getactiveconfigfile").then((function(e){return e.json()}))}function ut(e){var t=e.checked,n=e.filename,a=e.onChange,r=(t?"Unselect ":"Select ")+n;return c.a.createElement(L,{tooltip:r,checked:t,onChange:a})}function pt(e){var t=e.selectedFiles,n=e.downloadAsZip,a=t.size>1?"files":"file";return c.a.createElement(I,{icon:h.j,tooltip:t.isEmpty()?"Download selected files<br>Select at least one file first!":"Download ".concat(t.size," ").concat(a," as zip file"),enabled:!t.isEmpty(),onClick:n})}function ft(e){var t=e.selectedFiles,n=t.size>1?"files":"file";return c.a.createElement(I,{icon:h.i,tooltip:t.isEmpty()?"Delete selected files<br>Select at least one file first!":"Delete ".concat(t.size," ").concat(n),enabled:!t.isEmpty(),onClick:e.delete})}function dt(e){var t=e.fileStatus,n={icon:h.p};return null===t||"upload"!==t.action||""!==t.filename||t.success||(n={icon:h.a,className:"error-text"}),c.a.createElement(V,{icon:n.icon,tooltip:"Upload files",onChange:e.upload,className:n.className,multiple:!0})}function mt(e){var t=e.active,n=e.onClick;return c.a.createElement(I,{icon:t?h.b:h.c,tooltip:t?"This config is active and will be used by default":"Make this config active<br> It will then be used by default",className:t?"highlighted-button":"",onClick:n})}function ht(e){var t=e.disableReason,n=e.filename,a=e.fileStatus,r=e.saveConfig,i={icon:h.h};return t||null===a||"save"!==a.action||a.filename!==n||(i=a.success?{icon:h.g,className:"success-text"}:{icon:h.a,className:"error-text"}),c.a.createElement(I,{icon:i.icon,className:i.className,enabled:!t,tooltip:t||"Save from GUI to ".concat(n),onClick:function(){return r(n)}})}function gt(e){var t=e.filename,n=e.fileStatus,a=e.loadConfig,r={icon:h.o};return null!==n&&"load"===n.action&&n.filename===t&&(r=n.success?{icon:h.g,className:"success-text"}:{icon:h.a,className:"error-text"}),c.a.createElement(I,{icon:r.icon,className:r.className,tooltip:"Load into GUI from ".concat(t),onClick:function(){return a(t)}})}function vt(e){var t=e.type,n=e.filename,a=e.isCurrentConfig,r="button button-with-text "+(a?"highlighted-button":"");return c.a.createElement("a",{className:r,style:{width:"max-content"},"data-tip":"Download "+n+(a?"<br>This is the config file currently loaded in this Editor":""),download:n,target:"_blank",rel:"noopener noreferrer",href:"/".concat(t,"/").concat(n)},n)}function yt(e){var t=e.fileStatus,n=e.filename;return t&&!t.success&&t.filename===n?c.a.createElement("div",{className:t.success?"success-text":"error-text"},"Could not ",t.action," config:",c.a.createElement("br",null),t.statusText):null}function bt(e,t){return function(e){return e.trim().length>0}(e)?t.includes(e)?'File "'.concat(e,'" already exists'):void 0:"Please enter a valid file name."}var Ct=n(122),Et=n.n(Ct),kt=n(124);function xt(e){if(0===e.level.length)return null;var t=e.level.map((function(t,n){return c.a.createElement(St,{key:n,level:t,clipped:e.clipped})}));return c.a.createElement("div",{className:"split-20-80"},c.a.createElement("div",null,e.title),c.a.createElement("div",null,t))}function St(e){var t=e.clipped?"var(--error-text-color)":"var(--success-text-color)",n=e.level;return n<-100&&(n=-100),n>0&&(n=0),n+=100,c.a.createElement(kt.a,{percent:n,strokeWidth:4,trailWidth:4,strokeColor:t,strokeLinecap:"square",trailColor:"#E9E9E9"})}var wt=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).mute=r.mute.bind(Object(i.a)(r)),r.dim=r.dim.bind(Object(i.a)(r)),r.state={volume:0,mute:!1,dim:!1},r.updateVolume(),r}return Object(r.a)(n,[{key:"updateVolume",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/getparam/volume");case 2:if(t=e.sent,n=0,e.prev=4,!t.ok){e.next=12;break}return e.t0=parseInt,e.next=9,t.text();case 9:e.t1=e.sent,n=(0,e.t0)(e.t1,10),this.setState({volume:n});case 12:e.next=16;break;case 14:e.prev=14,e.t2=e.catch(4);case 16:case"end":return e.stop()}}),e,this,[[4,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t,n){var a=this.state,r=a.volume,i=a.mute;r===t.volume&&i===t.mute||this.setVolume(i?-99:r)}},{key:"mute",value:function(){this.setState((function(e){return{mute:!e.mute}}))}},{key:"dim",value:function(){this.setState((function(e){var t=e.volume,n=e.dim;return{volume:t+(n?20:-20),dim:!n}}))}},{key:"setVolume",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/setparam/volume",{method:"POST",headers:{"Content-Type":"text/plain; charset=us-ascii"},body:t.toString()});case 2:return n=e.sent,e.next=5,n.text();case 5:a=e.sent,this.props.setMessage(a);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,n=this.state,a=n.volume,r=n.mute,i=n.dim;return c.a.createElement(P,{title:c.a.createElement(c.a.Fragment,null,"Volume",c.a.createElement("div",{style:{display:"inline-block",width:"5ch",textAlign:"right",marginLeft:"5px"}},r?"":a+"dB"),c.a.createElement(I,{icon:h.r,tooltip:r?"Un-Mute":"Mute",smallButton:!0,className:r?"highlighted-button":"",onClick:this.mute}),c.a.createElement(I,{icon:h.q,tooltip:i?"Un-Dim":"Dim (-20dB)",smallButton:!0,className:i?"highlighted-button":"",enabled:i||a>=-79,onClick:this.dim}))},c.a.createElement(xt,{title:"In",level:t.capture_rms,clipped:t.clipped}),c.a.createElement("input",{style:{width:"100%",margin:0,padding:0},type:"range",min:-99,max:"0",value:r?-99:a,id:"volume",onChange:function(t){return e.setState({volume:t.target.valueAsNumber,mute:!1,dim:!1})}}),c.a.createElement(xt,{title:"Out",level:t.playback_rms,clipped:t.clipped}))}}]),n}(c.a.Component),Ft=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).offline_states=["backend offline","offline"],r.state={clearTimer:function(){},msg:"",capturesignalrms:[],playbacksignalrms:[],cdsp_status:"backend offline",rateadjust:"",capturerate:"",bufferlevel:"",clippedsamples:"",clipped:!1,cdsp_version:"",py_cdsp_version:"",backend_version:""},r.timer=r.timer.bind(Object(i.a)(r)),r.fetchConfig=r.fetchConfig.bind(Object(i.a)(r)),r.applyConfig=r.applyConfig.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=setInterval(this.timer,500),this.setState({clearTimer:function(){return clearInterval(t)}}),this.timer(),this.loadCurrentConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.state.clearTimer()}},{key:"timer",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/status");case 3:return e.next=5,e.sent.json();case 5:t=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t={cdsp_status:"backend offline",capturesignalrms:[],playbacksignalrms:[],capturerate:"",rateadjust:"",bufferlevel:"",clippedsamples:"",cdsp_version:"",py_cdsp_version:"",backend_version:""};case 11:this.setState((function(e){return Object(p.a)(Object(p.a)({},t),{},{clipped:e.clippedsamples>=0&&t.clippedsamples>e.clippedsamples})}));case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchConfig",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/getconfig");case 2:return t=e.sent,e.next=5,t.json();case 5:(n=e.sent)?(this.setState({msg:"OK"}),this.props.setConfig(n)):this.setState({msg:"No config received"});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyConfig",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/setconfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:this.props.currentConfigFile,config:this.props.config})});case 2:return t=e.sent,e.next=5,t.text();case 5:n=e.sent,this.setState({msg:n});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCurrentConfig",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct();case 2:t=e.sent,this.setState({msg:"OK"}),this.props.setCurrentConfig(t.configFileName,t.config);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.currentConfigFile,n=this.state.cdsp_status;return c.a.createElement("section",{className:"tabpanel",style:{width:"250px"}},c.a.createElement("img",{src:Et.a,alt:"graph",width:"100%",height:"100%"}),!this.offline_states.includes(n)&&c.a.createElement(wt,{capture_rms:this.state.capturesignalrms,playback_rms:this.state.playbacksignalrms,clipped:this.state.clipped,setMessage:function(t){return e.setState({msg:t})}}),c.a.createElement(P,{title:"CamillaDSP"},c.a.createElement("div",{className:"two-column-grid"},c.a.createElement("div",{className:"alignRight"},"State:"),c.a.createElement("div",null,n),c.a.createElement("div",{className:"alignRight"},"Capture samplerate:"),c.a.createElement("div",null,this.state.capturerate),c.a.createElement("div",{className:"alignRight"},"Rate adjust:"),c.a.createElement("div",null,this.state.rateadjust),c.a.createElement("div",{className:"alignRight"},"Clipped samples:"),c.a.createElement("div",null,this.state.clippedsamples),c.a.createElement("div",{className:"alignRight"},"Buffer level:"),c.a.createElement("div",null,this.state.bufferlevel),c.a.createElement("div",{className:"alignRight"},"Message:"),c.a.createElement("div",null,this.state.msg))),c.a.createElement(P,{title:"Config"},t&&c.a.createElement("div",{style:{width:"220px",overflowWrap:"break-word",textAlign:"center",margin:"0 auto 5px"}},t),c.a.createElement("div",{className:"two-column-grid"},c.a.createElement(q,{text:"Fetch from DSP","data-tip":"Fetch active config from the running CamillaDSP process",onClick:this.fetchConfig}),c.a.createElement(q,{text:"Apply to DSP","data-tip":t?"Apply config to the running CamillaDSP process, and save to ".concat(t):"Apply config to the running CamillaDSP process",onClick:this.applyConfig})),c.a.createElement(_t,{config:this.props.config,setErrors:this.props.setErrors})),c.a.createElement("div",{className:"versions"},c.a.createElement("div",null,"CamillaDSP ",this.state.cdsp_version),c.a.createElement("div",null,"pyCamillaDSP ",this.state.py_cdsp_version),c.a.createElement("div",null,"Backend ",this.state.backend_version)))}}]),n}(c.a.Component),_t=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).default_message="NOT CHECKED",r.get_config_errors=r.get_config_errors.bind(Object(i.a)(r)),r.state={message:r.default_message},r}return Object(r.a)(n,[{key:"componentDidUpdate",value:function(e){Je()(e.config,this.props.config)||this.get_config_errors(this.props.config)}},{key:"get_config_errors",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,a,r,i,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/validateconfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.text();case 7:a=e.sent,this.setState({message:a}),this.props.setErrors(me),e.next=19;break;case 12:return e.next=14,n.json();case 14:r=e.sent,i=he(r),l=i({path:[]}),this.setState({message:"Config has errors"+(l?":\n"+l:"")}),this.props.setErrors(i);case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),this.setState({message:"Validation failed"}),this.props.setErrors(me);case 25:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this.state.message;return e=t===this.default_message?"var(--neutral-text-color)":"OK"===t?"var(--success-text-color)":"var(--error-text-color)",c.a.createElement("div",{className:"config-status",style:{color:e,whiteSpace:"pre-wrap"}},t)}}]),n}(c.a.Component),Ot=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleConfig=r.handleConfig.bind(Object(i.a)(r)),r.updateConfig=r.updateConfig.bind(Object(i.a)(r)),r.setCurrentConfig=r.setCurrentConfig.bind(Object(i.a)(r)),r.setErrors=r.setErrors.bind(Object(i.a)(r)),r.switchTab=r.switchTab.bind(Object(i.a)(r)),r.state={activetab:0,guiConfig:{hide_capture_samplerate:!1,hide_silence:!1,hide_capture_device:!1,hide_playback_device:!1,hide_rate_monitoring:!1,coeff_dir:""},config:{devices:{samplerate:48e3,chunksize:1024,queuelimit:4,silence_threshold:0,silence_timeout:0,enable_rate_adjust:!1,adjust_period:3,target_level:1024,enable_resampling:!0,resampler_type:"FastAsync",capture_samplerate:44100,stop_on_rate_change:!1,rate_measure_interval:1,capture:{type:"Alsa",channels:2,format:"S32LE",device:"hw:0",retry_on_error:!1,avoid_blocking_read:!1},playback:{type:"Alsa",channels:2,format:"S32LE",device:"hw:0"}},filters:{},mixers:{},pipeline:[]},errors:me},fetch("/api/guiconfig").then((function(e){return e.json()})).then((function(e){return r.setState({guiConfig:e})})),r}return Object(r.a)(n,[{key:"handleConfig",value:function(e){this.setState({config:e})}},{key:"updateConfig",value:function(e){this.setState((function(t){var n=m()(t.config);return e(n),{config:n}}))}},{key:"setCurrentConfig",value:function(e,t){this.setState({currentConfigFile:e,config:t})}},{key:"setErrors",value:function(e){this.setState({errors:e})}},{key:"componentDidUpdate",value:function(e){it.a.rebuild(),console.log("=============rebuild tooltips")}},{key:"switchTab",value:function(e){this.setState({activetab:e})}},{key:"render",value:function(){var e=this.state.errors;return s.createElement("div",{className:"configapp"},s.createElement(it.a,{multiline:!0}),s.createElement(Ft,{currentConfigFile:this.state.currentConfigFile,config:this.state.config,setConfig:this.handleConfig,setErrors:this.setErrors,setCurrentConfig:this.setCurrentConfig}),s.createElement(rt.d,{className:"configtabs",selectedIndex:this.state.activetab,onSelect:this.switchTab},s.createElement(rt.b,null,s.createElement(rt.a,null,"Devices ",e({path:["devices"],includeChildren:!0})&&s.createElement(jt,null)),s.createElement(rt.a,null,"Filters ",e({path:["filters"],includeChildren:!0})&&s.createElement(jt,null)),s.createElement(rt.a,null,"Mixers ",e({path:["mixers"],includeChildren:!0})&&s.createElement(jt,null)),s.createElement(rt.a,null,"Pipeline ",e({path:["pipeline"],includeChildren:!0})&&s.createElement(jt,null)),s.createElement(rt.a,null,"Files")),s.createElement(rt.c,null,s.createElement(we,{devices:this.state.config.devices,guiConfig:this.state.guiConfig,updateConfig:this.updateConfig,errors:ge(e,"devices")})),s.createElement(rt.c,null,s.createElement(ve,{filters:this.state.config.filters,samplerate:this.state.config.devices.samplerate,channels:this.state.config.devices.capture.channels,coeffDir:this.state.guiConfig.coeff_dir,updateConfig:this.updateConfig,errors:ge(e,"filters")})),s.createElement(rt.c,null,s.createElement(qe,{mixers:this.state.config.mixers,updateConfig:this.updateConfig,errors:ge(e,"mixers")})),s.createElement(rt.c,null,s.createElement(Ye,{config:this.state.config,updateConfig:this.updateConfig,errors:ge(e,"pipeline")})),s.createElement(rt.c,null,s.createElement(ot,{currentConfigFile:this.state.currentConfigFile,config:this.state.config,setCurrentConfig:this.setCurrentConfig}))))}}]),n}(s.Component);function jt(e){return s.createElement(z,{icon:h.a,tooltip:"There are errors on this tab",style:{color:"var(--error-text-color)"}})}u.render(s.createElement(Ot,null),document.getElementById("root"))}},[[189,1,2]]]);
//# sourceMappingURL=main.1b3ac690.chunk.js.map